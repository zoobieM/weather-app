<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Weather App</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: linear-gradient(to right, #00c6ff, #0072ff);
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      margin: 0;
    }
    .weather-container {
      background: white;
      padding: 20px;
      border-radius: 15px;
      text-align: center;
      width: 360px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.2);
    }
    input {
      padding: 10px;
      width: 80%;
      margin-bottom: 10px;
      border: 1px solid #ccc;
      border-radius: 8px;
    }
    button {
      padding: 10px 20px;
      background: #0072ff;
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      margin: 5px;
    }
    button:hover {
      background: #0056cc;
    }
    .error {
      color: red;
      margin-top: 10px;
    }
    .weather-result {
      margin-top: 20px;
    }
    .weather-result img {
      width: 60px;
      height: 60px;
    }
  </style>
</head>
<body>
  <div class="weather-container">
    <h2>Weather App</h2>
    <input type="text" id="cityInput" placeholder="Enter city (e.g. Faridabad)">
    <br>
    <button onclick="getWeather()">Get Weather</button>
    <button onclick="getLocationWeather()">Use My Location</button>
    <p id="error" class="error"></p>
    <div id="weatherResult" class="weather-result"></div>
  </div>

  <script>
    const apiKey = "b381f93031c2471e895173608252008";

    // üî• City mapping for unsupported names
    const cityMap = {
      "faridabad": "28.4089,77.3178",
      "new delhi": "28.6139,77.2090",
      "delhi": "28.7041,77.1025",
      "gurgaon": "28.4595,77.0266",
      "noida": "28.5355,77.3910"
    };

    async function getWeather(city) {
      const errorElement = document.getElementById("error");
      const weatherResult = document.getElementById("weatherResult");

      errorElement.textContent = "";
      weatherResult.innerHTML = "";

      if (!city) {
        city = document.getElementById("cityInput").value.trim();
      }

      if (!city) {
        errorElement.textContent = "Please enter a city name.";
        return;
      }

      // üó∫Ô∏è If city is in our map, replace with coordinates
      if (cityMap[city.toLowerCase()]) {
        city = cityMap[city.toLowerCase()];
      }

      try {
        const response = await fetch(
          `https://api.weatherapi.com/v1/current.json?key=${apiKey}&q=${encodeURIComponent(city)}`
        );

        if (!response.ok) {
          throw new Error("City not found. Try another nearby location.");
        }

        const data = await response.json();

        weatherResult.innerHTML = `
          <h3>${data.location.name}, ${data.location.country}</h3>
          <p><strong>Temperature:</strong> ${data.current.temp_c}¬∞C</p>
          <p><strong>Condition:</strong> ${data.current.condition.text}</p>
          <img src="${data.current.condition.icon}" alt="Weather Icon">
          <p><strong>Humidity:</strong> ${data.current.humidity}%</p>
          <p><strong>Wind:</strong> ${data.current.wind_kph} kph ${data.current.wind_dir}</p>
        `;
      } catch (error) {
        errorElement.textContent = error.message;
      }
    }

    function getLocationWeather() {
      if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(
          async (position) => {
            const lat = position.coords.latitude;
            const lon = position.coords.longitude;
            getWeather(`${lat},${lon}`);
          },
          () => {
            document.getElementById("error").textContent = 
              "Location access denied. Please enter city manually.";
          }
        );
      } else {
        document.getElementById("error").textContent = 
          "Geolocation is not supported by this browser.";
      }
    }
  </script>
</body>
</html>
